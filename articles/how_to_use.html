<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to use driveR • driveR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="How to use driveR">
<meta property="og:description" content="driveR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">driveR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/how_to_use.html">How to use driveR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/egeulgen/driveR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="how_to_use_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to use driveR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/egeulgen/driveR/blob/HEAD/vignettes/how_to_use.Rmd" class="external-link"><code>vignettes/how_to_use.Rmd</code></a></small>
      <div class="hidden name"><code>how_to_use.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Cancer genomes contain large numbers of somatic alterations but few genes drive tumor development. Identifying cancer driver genes is critical for precision oncology. Most of current approaches either identify driver genes based on mutational recurrence or using estimated scores predicting the functional consequences of mutations.</p>
<p><code>driveR</code> is a tool for personalized or batch analysis of genomic data for driver gene prioritization by combining genomic information and prior biological knowledge. As features, driveR uses coding impact metaprediction scores, non-coding impact scores, somatic copy number alteration scores, hotspot gene/double-hit gene condition, ‘phenolyzer’ gene scores and memberships to cancer-related KEGG pathways. It uses these features to estimate cancer-type-specific probabilities for each gene of being a cancer driver using the related task of a multi-task learning classification model.</p>
<blockquote>
<p>The package supports GRCh37 (default) and GRCh38 genomic positions, which can be specified via the <code>build</code> argument.</p>
</blockquote>
<p>The method is described in detail in <em>Ülgen E, Sezerman OU. driveR: a novel method for prioritizing cancer driver genes using somatic genomics data. BMC Bioinformatics. 2021 May 24;22(1):263.<a href="https://doi.org/10.1186/s12859-021-04203-7" class="external-link">https://doi.org/10.1186/s12859-021-04203-7</a></em></p>
<p>Below are some example usage cases for <code>driveR</code>:</p>
</div>
<div class="section level2">
<h2 id="predicting-impact-of-coding-variants">Predicting Impact of Coding Variants<a class="anchor" aria-label="anchor" href="#predicting-impact-of-coding-variants"></a>
</h2>
<p>For scoring the impact of coding variants, we devised a metapredictor model that utilizes impact prediction scores from 12 different tools: SIFT, PolyPhen-2 (HumDiv scores), LRT, MutationTaster, Mutation Assessor, FATHMM, GERP++, PhyloP, CADD, VEST, SiPhy and DANN. Annotations for all these tools are available in dbNFSP via ANNOVAR. We provide with the package 2 example (shortened) ANNOVAR outputs (see next sections):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://egeulgen.github.io/driveR/">driveR</a></span><span class="op">)</span></span>
<span><span class="va">path2annovar_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example.hg19_multianno.csv"</span>,</span>
<span>                                 package <span class="op">=</span> <span class="st">"driveR"</span><span class="op">)</span></span></code></pre></div>
<p>We can calculate impact scores for all coding variants in this ANNOVAR file via <code><a href="../reference/predict_coding_impact.html">predict_coding_impact()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metaprediction_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_coding_impact.html">predict_coding_impact</a></span><span class="op">(</span>annovar_csv_path <span class="op">=</span> <span class="va">path2annovar_csv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metaprediction_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;       gene_symbol metaprediction_score</span></span>
<span><span class="co">#&gt; 531         MUTYH                1.000</span></span>
<span><span class="co">#&gt; 2144        AMPD3                1.000</span></span>
<span><span class="co">#&gt; 6609         RPIA                1.000</span></span>
<span><span class="co">#&gt; 8510        GPAT3                1.000</span></span>
<span><span class="co">#&gt; 10040        GUSB                1.000</span></span>
<span><span class="co">#&gt; 854      SELENBP1                0.998</span></span></code></pre></div>
<p>By default, <code><a href="../reference/predict_coding_impact.html">predict_coding_impact()</a></code> keeps only the maximal score per gene. This behavior can be altered by setting <code>keep_highest_score = FALSE</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metaprediction_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_coding_impact.html">predict_coding_impact</a></span><span class="op">(</span>annovar_csv_path <span class="op">=</span> <span class="va">path2annovar_csv</span>, </span>
<span>                                           keep_highest_score <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Also by default, <code><a href="../reference/predict_coding_impact.html">predict_coding_impact()</a></code> keeps only the first gene symbol for genes where multiple symbols were annotated. This behavior can be altered by setting <code>keep_single_symbol = FALSE</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metaprediction_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_coding_impact.html">predict_coding_impact</a></span><span class="op">(</span>annovar_csv_path <span class="op">=</span> <span class="va">path2annovar_csv</span>, </span>
<span>                                           keep_single_symbol <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The default <code>na.string</code> (string that was used to indicate when a score is not available during annotation with ANNOVAR) is “.”, this can be altered via:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metaprediction_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_coding_impact.html">predict_coding_impact</a></span><span class="op">(</span>annovar_csv_path <span class="op">=</span> <span class="va">path2annovar_csv</span>, </span>
<span>                                           na.string <span class="op">=</span> <span class="st">"NA"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="driver-gene-prioritization---personalized-analysis">Driver Gene Prioritization - Personalized Analysis<a class="anchor" aria-label="anchor" href="#driver-gene-prioritization---personalized-analysis"></a>
</h2>
<p>Below, a step-by-step work flow for <code>driveR</code> for an individual tumor sample is provided. Note that some steps require operations outside of R. The example data provided within the package are for a lung adenocarcinoma patient studied in Imielinski et al. <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="section level3">
<h3 id="load-the-package-and-prepare-input-data">Load the package and prepare input data<a class="anchor" aria-label="anchor" href="#load-the-package-and-prepare-input-data"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://egeulgen.github.io/driveR/">driveR</a></span><span class="op">)</span></span></code></pre></div>
<p>As input, <code><a href="../reference/create_features_df.html">create_features_df()</a></code>, the function used to create the features table for driver gene prioritization, requires the following:</p>
<ul>
<li>
<code>annovar_csv_path</code>: the <code>/path/to/ANNOVAR/csv/output/file</code>
</li>
<li>
<code>scna_df</code>: a data frame containing SCNA segments, containing the columns “chr”, “start”, “end” and “log2ratio”</li>
<li>
<code>phenolyzer_annotated_gene_list_path</code>: the <code>/path/to/phenolyzer/annotated_gene_list/output/file</code>
</li>
</ul>
<div class="section level4">
<h4 id="annovar-csv-output">ANNOVAR CSV output<a class="anchor" aria-label="anchor" href="#annovar-csv-output"></a>
</h4>
<p>We first run ANNOVAR. An example command provided below:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="ex">table_annovar.pl</span> example.avinput ~/annovar/humandb/ -buildver hg19 -out /path/to/output -remove -protocol refGene,cytoBand,exac03,avsnp150,dbnsfp30a,cosmic92_coding,cosmic92_noncoding -operation gx,r,f,f,f,f,f -nastring . -csvout -polish</span></code></pre></div>
<p>The required filters are, as listed in the above command, <code>refGene,cytoBand,exac03,avsnp147,dbnsfp30a,cosmic91_coding,cosmic91_noncoding</code>.</p>
<p>With the package, an example (modified) ANNOVAR csv output file is available:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path2annovar_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example.hg19_multianno.csv"</span>,</span>
<span>                                 package <span class="op">=</span> <span class="st">"driveR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="scna-table">SCNA table<a class="anchor" aria-label="anchor" href="#scna-table"></a>
</h4>
<p>Next, we prepare a SCNA data frame (GRCh37 or GRCh38). Again, an example data frame (GRCh37) is provided within the package:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_scna_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;   chr   start     end log2ratio</span></span>
<span><span class="co">#&gt; 1   1       1    9001 0.8875253</span></span>
<span><span class="co">#&gt; 2   1    9002   10001 0.6959938</span></span>
<span><span class="co">#&gt; 3   1   10002 3695599 0.3785116</span></span>
<span><span class="co">#&gt; 4   1 3695600 4715896 0.4646683</span></span>
<span><span class="co">#&gt; 5   1 4715897 4717788 0.4005379</span></span>
<span><span class="co">#&gt; 6   1 4717789 5798840 0.4854268</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="phenolyzer-output">phenolyzer output<a class="anchor" aria-label="anchor" href="#phenolyzer-output"></a>
</h4>
<p>Finally, for the phenolyzer annotated_gene_list output file, we first obtain the genes to be scored using <code>create_features_df</code> and setting <code>prep_phenolyzer_input=TRUE</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phenolyzer_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_features_df.html">create_features_df</a></span><span class="op">(</span>annovar_csv_path <span class="op">=</span> <span class="va">path2annovar_csv</span>,</span>
<span>                                       scna_df <span class="op">=</span> <span class="va">example_scna_table</span>,</span>
<span>                                       prep_phenolyzer_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                       build <span class="op">=</span> <span class="st">"GRCh37"</span><span class="op">)</span></span></code></pre></div>
<p>Next, we save these genes to be used as input for phenolyzer:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="va">phenolyzer_genes</span><span class="op">)</span>, </span>
<span>            file <span class="op">=</span> <span class="st">"input_genes.txt"</span>, </span>
<span>            row.names <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="cn">FALSE</span>, quote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We create another text file, named <code>phenolyzer_disease.txt</code>, containing the phenotype (i.e. cancer type. in this case “lung adenocarcinoma”) to be used for scoring with phenolyzer. An example command for running phenolyzer is provided below:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">perl</span> ~/phenolyzer/disease_annotation.pl -f phenolyzer_disease.txt -prediction -phenotype -logistic --gene input_genes.txt -out phenolyzer_out/example</span></code></pre></div>
<p>This should produce, among other outputs, the annotated_gene_list output file. An example annotated_gene_list output file is provided within the package:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path2phenolyzer_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example.annotated_gene_list"</span>,</span>
<span>                                    package <span class="op">=</span> <span class="st">"driveR"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="create-the-features-data-frame">Create the features data frame<a class="anchor" aria-label="anchor" href="#create-the-features-data-frame"></a>
</h3>
<p>After creating the necessary input data (as detailed above), we simply run <code><a href="../reference/create_features_df.html">create_features_df()</a></code> to obtain the features data frame:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">features_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_features_df.html">create_features_df</a></span><span class="op">(</span>annovar_csv_path <span class="op">=</span> <span class="va">path2annovar_csv</span>,</span>
<span>                                  scna_df <span class="op">=</span> <span class="va">example_scna_table</span>, </span>
<span>                                  phenolyzer_annotated_gene_list_path <span class="op">=</span> <span class="va">path2phenolyzer_out</span>,</span>
<span>                                  build <span class="op">=</span> <span class="st">"GRCh37"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prioritize-cancer-driver-genes">Prioritize cancer driver genes<a class="anchor" aria-label="anchor" href="#prioritize-cancer-driver-genes"></a>
</h3>
<p>Finally, we can prioritize cancer driver genes using <code><a href="../reference/prioritize_driver_genes.html">prioritize_driver_genes()</a></code>. For this function, <code>cancer_type</code> can be of the short names for the 21 different cancer types that was used to train the multi-task learning model utilized in this package:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">MTL_submodel_descriptions</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">short_name</th>
<th align="left">description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">BLCA</td>
<td align="left">Bladder Urothelial Cancer</td>
</tr>
<tr class="even">
<td align="left">BRCA</td>
<td align="left">Breast Cancer</td>
</tr>
<tr class="odd">
<td align="left">CESC</td>
<td align="left">Cervical Squamous Cell Carcinoma</td>
</tr>
<tr class="even">
<td align="left">COAD</td>
<td align="left">Colon Adenocarcinoma</td>
</tr>
<tr class="odd">
<td align="left">GBM</td>
<td align="left">Brain Glioblastoma Multiforme</td>
</tr>
<tr class="even">
<td align="left">HNSC</td>
<td align="left">Head and Neck Squamous Cell Carcinoma</td>
</tr>
<tr class="odd">
<td align="left">KIRC</td>
<td align="left">Kidney Renal Clear Cell Carcinoma</td>
</tr>
<tr class="even">
<td align="left">KIRP</td>
<td align="left">Kidney Renal Papillary Cell Carcinoma</td>
</tr>
<tr class="odd">
<td align="left">LAML</td>
<td align="left">Acute Myeloid Leukemia</td>
</tr>
<tr class="even">
<td align="left">LGG</td>
<td align="left">Brain Lower Grade Glioma</td>
</tr>
<tr class="odd">
<td align="left">LIHC</td>
<td align="left">Liver Hepatocellular carcinoma</td>
</tr>
<tr class="even">
<td align="left">LUAD</td>
<td align="left">Lung Adenocarcinoma</td>
</tr>
<tr class="odd">
<td align="left">LUSC</td>
<td align="left">Lung Squamous Cell Carcinoma</td>
</tr>
<tr class="even">
<td align="left">OV</td>
<td align="left">Ovarian Serous Cystadenocarcinoma</td>
</tr>
<tr class="odd">
<td align="left">PAAD</td>
<td align="left">Pancreatic Cancer</td>
</tr>
<tr class="even">
<td align="left">PRAD</td>
<td align="left">Prostate Adenocarcinoma</td>
</tr>
<tr class="odd">
<td align="left">READ</td>
<td align="left">Rectum Adenocarcinoma</td>
</tr>
<tr class="even">
<td align="left">SKCM</td>
<td align="left">Skin Cutaneous melanoma</td>
</tr>
<tr class="odd">
<td align="left">STAD</td>
<td align="left">Gastric Adenocarcinoma</td>
</tr>
<tr class="even">
<td align="left">THCA</td>
<td align="left">Head and Neck Thyroid Carcinoma</td>
</tr>
<tr class="odd">
<td align="left">UCEC</td>
<td align="left">Uterine Corpus Endometrial Carcinoma</td>
</tr>
</tbody>
</table>
<p>Below is the example run for the lung adenocarcinoma patient:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">driver_prob_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prioritize_driver_genes.html">prioritize_driver_genes</a></span><span class="op">(</span>features_df <span class="op">=</span> <span class="va">features_df</span>,</span>
<span>                                          cancer_type <span class="op">=</span> <span class="st">"LUAD"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">driver_prob_df</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;      gene_symbol driverness_prob prediction</span></span>
<span><span class="co">#&gt; 842         TP53       0.9614544     driver</span></span>
<span><span class="co">#&gt; 3211       CCND3       0.8604087     driver</span></span>
<span><span class="co">#&gt; 3654        EGFR       0.7485849 non-driver</span></span>
<span><span class="co">#&gt; 1966       EP300       0.5799741 non-driver</span></span>
<span><span class="co">#&gt; 679          ATM       0.5753917 non-driver</span></span>
<span><span class="co">#&gt; 510          KDR       0.5012796 non-driver</span></span>
<span><span class="co">#&gt; 386       IFNA10       0.4526894 non-driver</span></span>
<span><span class="co">#&gt; 740         IL7R       0.4271572 non-driver</span></span>
<span><span class="co">#&gt; 3572      PIK3R2       0.3780803 non-driver</span></span>
<span><span class="co">#&gt; 2300         ATR       0.3666499 non-driver</span></span></code></pre></div>
<p>The function returns a data frame of genes with probabilities of being cancer driver genes (using the selected sub-model of a multi-task learning model trained using 21 different cancer types) and the prediction of driver genes based on a cancer type specific probability threshold. In the above example, the top 10 genes contain recognizable cancer driver genes.</p>
</div>
</div>
<div class="section level2">
<h2 id="driver-gene-prioritization---batch-analysis">Driver Gene Prioritization - Batch Analysis<a class="anchor" aria-label="anchor" href="#driver-gene-prioritization---batch-analysis"></a>
</h2>
<p>Below, a step-by-step work flow for <code>driveR</code> for a cohort of tumor samples is provided. Note that some steps require operations outside of R. The example data provided within the package are for 10 randomly-selected samples from The Cancer Genome Atlas (TCGA) program’s LAML (Acute Myeloid Leukemia) cohort.</p>
<div class="section level3">
<h3 id="load-the-package-and-prepare-input-data-1">Load the package and prepare input data<a class="anchor" aria-label="anchor" href="#load-the-package-and-prepare-input-data-1"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://egeulgen.github.io/driveR/">driveR</a></span><span class="op">)</span></span></code></pre></div>
<p>As before, as input, <code><a href="../reference/create_features_df.html">create_features_df()</a></code>, the function used to create the features table for driver gene prioritization, requires the following:</p>
<ul>
<li>
<code>annovar_csv_path</code>: the <code>/path/to/ANNOVAR/csv/output/file</code>
</li>
<li>
<code>scna_df</code>: a data frame containing SCNA segments, containing the columns “chr”, “start”, “end”, “log2ratio” and <strong>“tumor_id”</strong>
</li>
<li>
<code>phenolyzer_annotated_gene_list_path</code>: the <code>/path/to/phenolyzer/annotated_gene_list/output/file</code>
</li>
</ul>
<div class="section level4">
<h4 id="annovar-csv-output-1">ANNOVAR CSV output<a class="anchor" aria-label="anchor" href="#annovar-csv-output-1"></a>
</h4>
<p>The required filters are again, as listed in the example ANNOVAR command above, <code>refGene,cytoBand,exac03,avsnp147,dbnsfp30a,cosmic91_coding,cosmic91_noncoding</code>. Additionally, for cohort-level analysis, a column named <code>tumor_id</code> is required, containing tumor id of each variant.</p>
<p>With the package, an example cohort-level (modified) ANNOVAR csv output file is available:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path2annovar_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_cohort.hg19_multianno.csv"</span>,</span>
<span>                                 package <span class="op">=</span> <span class="st">"driveR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="scna-table-1">SCNA table<a class="anchor" aria-label="anchor" href="#scna-table-1"></a>
</h4>
<p>Next, we prepare a SCNA data frame (GRCh37 is required). Again, an example data frame is provided within the package:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_cohort_scna_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;       chr     start       end log2ratio tumor_id</span></span>
<span><span class="co">#&gt; 29597  22  25922342  42892582   -0.0085  DO21131</span></span>
<span><span class="co">#&gt; 29598  15  20581451  20586957    0.8688  DO21131</span></span>
<span><span class="co">#&gt; 29599   1  72768418  72809431    0.3540  DO21131</span></span>
<span><span class="co">#&gt; 29600  13  58814227  62806981    0.0023  DO21131</span></span>
<span><span class="co">#&gt; 29601   2 208354955 208359336   -0.8954  DO21131</span></span>
<span><span class="co">#&gt; 29602   5 117388963 120417166   -0.0114  DO21131</span></span></code></pre></div>
<p>Again, for cohort-level analysis, it’s crucial to have a column named <code>tumor_id</code> is required, containing tumor id for each SCNA segment.</p>
</div>
<div class="section level4">
<h4 id="phenolyzer-output-1">phenolyzer output<a class="anchor" aria-label="anchor" href="#phenolyzer-output-1"></a>
</h4>
<p>Finally, for the phenolyzer annotated_gene_list output file, we first obtain the genes to be scored using <code>create_features_df</code> and setting <code>prep_phenolyzer_input=TRUE</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phenolyzer_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_features_df.html">create_features_df</a></span><span class="op">(</span>annovar_csv_path <span class="op">=</span> <span class="va">path2annovar_csv</span>,</span>
<span>                                       scna_df <span class="op">=</span> <span class="va">example_cohort_scna_table</span>,</span>
<span>                                       prep_phenolyzer_input <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                       batch_analysis <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Next, we save these genes to be used as input for phenolyzer:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="va">phenolyzer_genes</span><span class="op">)</span>, </span>
<span>            file <span class="op">=</span> <span class="st">"input_genes.txt"</span>, </span>
<span>            row.names <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="cn">FALSE</span>, quote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We create another text file, named <code>phenolyzer_disease.txt</code>, containing the phenotype (i.e. cancer type. in this case “acute myeloid leukemia”) to be used for scoring with phenolyzer. An example command for running phenolyzer is provided below:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">perl</span> ~/phenolyzer/disease_annotation.pl -f phenolyzer_disease.txt -prediction -phenotype -logistic --gene input_genes.txt -out phenolyzer_out/example</span></code></pre></div>
<p>This should produce, among other outputs, the annotated_gene_list output file. An example annotated_gene_list output file for the cohort-level data is provided within the package:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path2phenolyzer_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_cohort.annotated_gene_list"</span>,</span>
<span>                                    package <span class="op">=</span> <span class="st">"driveR"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="create-the-features-data-frame-1">Create the features data frame<a class="anchor" aria-label="anchor" href="#create-the-features-data-frame-1"></a>
</h3>
<p>After creating the necessary input data (as detailed above), we simply run <code><a href="../reference/create_features_df.html">create_features_df()</a></code> to obtain the features data frame. Notice that we set <code>batch_analysis = TRUE</code>. When <code>batch_analysis = TRUE</code>, both the ANNOVAR output and the SCNA table should have a column named ‘tumor_id’.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">features_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_features_df.html">create_features_df</a></span><span class="op">(</span>annovar_csv_path <span class="op">=</span> <span class="va">path2annovar_csv</span>,</span>
<span>                                  scna_df <span class="op">=</span> <span class="va">example_cohort_scna_table</span>, </span>
<span>                                  phenolyzer_annotated_gene_list_path <span class="op">=</span> <span class="va">path2phenolyzer_out</span>,</span>
<span>                                  batch_analysis <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prioritize-cancer-driver-genes-1">Prioritize cancer driver genes<a class="anchor" aria-label="anchor" href="#prioritize-cancer-driver-genes-1"></a>
</h3>
<p>Finally, we can prioritize cancer driver genes using <code><a href="../reference/prioritize_driver_genes.html">prioritize_driver_genes()</a></code>.</p>
<p>Below is the example run for the acute myeloid leukemia cohort:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">driver_prob_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prioritize_driver_genes.html">prioritize_driver_genes</a></span><span class="op">(</span>features_df <span class="op">=</span> <span class="va">features_df</span>,</span>
<span>                                          cancer_type <span class="op">=</span> <span class="st">"LAML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">driver_prob_df</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;     gene_symbol driverness_prob prediction</span></span>
<span><span class="co">#&gt; 49         FLT3       0.9922470     driver</span></span>
<span><span class="co">#&gt; 5          TP53       0.9569072     driver</span></span>
<span><span class="co">#&gt; 291       EP300       0.9451127     driver</span></span>
<span><span class="co">#&gt; 338      CDKN2A       0.5800416 non-driver</span></span>
<span><span class="co">#&gt; 11        SMC1A       0.3474567 non-driver</span></span>
<span><span class="co">#&gt; 258      ANAPC4       0.2596510 non-driver</span></span>
<span><span class="co">#&gt; 311      IFNGR1       0.2538748 non-driver</span></span>
<span><span class="co">#&gt; 67         MDM4       0.2396303 non-driver</span></span>
<span><span class="co">#&gt; 324       TRAF3       0.2383674 non-driver</span></span>
<span><span class="co">#&gt; 359      PIEZO1       0.2371796 non-driver</span></span></code></pre></div>
<p>Once again, in the above example, the top 10 genes contain recognizable cancer driver genes.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Imielinski M, Greulich H, Kaplan B, et al. Oncogenic and sorafenib-sensitive ARAF mutations in lung adenocarcinoma. J Clin Invest. 2014;124(4):1582-6.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ege Ulgen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '21b3b36a9d378c47ddeef07e523fb44b',
    indexName: 'egeulgen_driver',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
